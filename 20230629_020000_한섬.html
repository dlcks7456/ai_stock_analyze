
    
    <link rel="stylesheet/less" type="text/css" href="https://tistory1.daumcdn.net/tistory/6187703/skin/images/analyze.less" />
    <script src="https://cdn.jsdelivr.net/npm/less"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@latest/dist/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartist-plugin-legend/0.6.2/chartist-plugin-legend.min.js" integrity="sha512-J82gmCXFu+eMIvhK2cCa5dIiKYfjFY4AySzCCjG4EcnglcPQTST/nEtaf5X6egYs9vbbXpttR7W+wY3Uiy37UQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
    // 연간/분기 차트 생성
    const financeSetChart = (className, labels, datas) => {
        const ctx = document.querySelector(className).getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: '매출액',
                    data: datas[0],
                    backgroundColor: 'rgba(16, 163, 127, 0.2)',
                    borderColor: 'rgba(16, 163, 127, 1)',
                    borderWidth: 1,
                    yAxisID: 'y1',
                    type: 'bar'
                }, {
                    label: '영업이익',
                    data: datas[1],
                    backgroundColor: 'rgba(0, 0, 128, 0.2)',
                    borderColor: 'rgba(0, 0, 128, 1)',
                    borderWidth: 1,
                    yAxisID: 'y1',
                    type: 'bar'
                }, {
                    label: '당기순이익',
                    data: datas[2],
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                    yAxisID: 'y1',
                    type: 'bar'
                }, {
                    label: '영업이익률',
                    data: datas[3],
                    backgroundColor: 'rgba(255, 223, 0, 0.2)',
                    borderColor: 'rgba(255, 223, 0, 1)',
                    borderWidth: 2,
                    yAxisID: 'y2',
                }, {
                    label: '당기순이익률',
                    data: datas[4],
                    backgroundColor: 'rgba(135, 206, 250, 0.2)',
                    borderColor: 'rgba(135, 206, 250, 1)',
                    borderWidth: 2,
                    yAxisID: 'y2',
                }]
            },
            options: {
                scales: {
                    y1: {
                        position: 'left',
                        ticks: {
                            callback: function(value, index, ticks) {
                                return `${value.toLocaleString()}억원`;
                            }
                        }
                    },
                    y2: {
                        beginAtZero: true,
                        position: 'right',
                        grid: {
                            drawOnChartArea: false,
                        },
                        ticks: {
                            callback: function(value, index, ticks) {
                                return `${value.toLocaleString()}%`;
                            }
                        }
                    }
                }
            }
        });
    }
    </script>
    <!-- START -->
    <!-- Head -->
    <h1>한섬:주식 재무 분석 & 적정주가 계산</h1>
    <div class="a-line"></div>
    <!-- Head END -->
    <!-- 안내사항 -->
    <div class="before-start">
        <ul>
            <li>FnGuide/NAVER 증권에서 <b>웹스크래핑한 데이터</b>입니다.</li>
            <li>모바일에서도 확인은 가능하지만 PC가 더 편리할 수 있습니다.</li>
            <li>티스토리 <b>모바일 앱</b>에서는 <span class="bad-value"><b>일부 기능이 작동하지 않습니다.</b></span></li>
            <li>이 포스트는 <b>2023/06/29 기준</b>입니다. <b>재무 데이터는 이후 변경될 수 있습니다.</b></li>
            <li><b>요약은 AI가 작성</b>했습니다.</li>
            <li><b>긍정적인 수치</b>는 <span class="good-value"><b>초록색 폰트</b></span>로 표시됩니다.</li>
            <li><b>부정적인 수치</b>는 <span class="bad-value"><b>빨간색 폰트</b></span>로 표시됩니다.</li>
            <li><span class="weight-value"><b>노란색 배경</b></span>은 <span class="weight-value"><b>가중 평균</b></span>으로 계산된 수치입니다.</li>
            <li>재무정보 중 <span class="weight-value"><b>가중 평균</b></span>으로 계산된 케이스는 <b>AI분석에서 제외</b>됩니다.</li>
            <li>재무정보의 차트는 범례를 클릭하면 해당 범례를 숨기거나 나타낼 수 있습니다.</li>
            <li><b>SRIM 적정주가 계산에서는 회사채 수익률을 변경해서 적용 가능합니다.</b></li>
            <li><b>자료는 참고용 정보</b>일 뿐입니다. <b>투자 결과에 대한 책임은 본인</b>에게 있습니다.</li>
        </ul>
    </div>
    <div class="a-line"></div>
    <div class="a-line"></div>
    <div class="fs-mypost-list">
        <div class="fs-mypost">🚀 바로가기</div>
        <div class="fs-mypost-link">
            <a href="#finance-datas">
                <div>재무정보</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="#fs-calc-result">
                <div>적정주가 계산 (영업이익*PER & SRIM)</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="#fs-summary-ai">
                <div>요약 (From. AI)</div>
            </a>
        </div>
    </div>
    <div class="a-line"></div>
    
    
    <!-- 종목 기본 정보 -->
    <div class="report-title">기본 정보</div>
    <div class="standard-info">
        <div class="info">
            <div class="info-cell">
                <div class="cell-head">종목 이름</div>
                <div class="cell-desc">한섬</div>
            </div>

            <div class="info-cell">
                <div class="cell-head">종목 코드</div>
                <div class="cell-desc">020000</div>
            </div>

            <div class="info-cell">
                <div class="cell-head">현재 주가</div>
                <div class="cell-desc">23,050원</div>
            </div>

            <div class="info-cell">
                <div class="cell-head">기준 날짜</div>
                <div class="cell-desc">2023/06/29 22:52</div>
            </div>
        </div>

        <div class="info-one">
            <div class="cell-head">시가 총액</div>
            <div class="cell-desc">583,700,000,000</div>
        </div>

        <div class="info-one">
            <div class="cell-head">발행주식수</div>
            <div class="cell-desc">24,630,000</div>
        </div>

        <div class="info-one">
            <div class="cell-head">자사주</div>
            <div class="cell-desc">2,660,406</div>
        </div>

        <div class="info-summary">
            <div class="cell-head">개요</div>
            <div class="cell-desc">
                <div class="info-industry">KSE  코스피 섬유,의복 | FICS  섬유 및 의복 | K200</div>
                <div class="info-detail">동사와 종속회사는 여성의류 제조, 판매를 주요 사업으로 함. TIME, TIME HOMME, MINE, SYSTEM 등이 동사 보유 주요 브랜드임. 동사는 트렌드에 앞서가는 소비자들을 위해 새로운 유통형태의 편집숍 'SPACE MUE'를 오픈함. 'LANVIN', 'SYSTEM homme', 'the CASHMERE', 'LATT' 등을 런칭하며 질적 경영을 고수하며 자타가 공인하는 패션업계 일등 회사가 되었음.</div>
            </div>
        </div>
    </div>
    <div class="fs-btn-a">
        <a title="NAVER 증권:한섬" href="https://finance.naver.com/item/main.nhn?code=020000">NAVER 증권 바로가기</a>
        <a title="FnGuide:한섬" href="http://comp.fnguide.com/SVO2/ASP/SVD_main.asp?pGB=1&gicode=A020000&cID=&MenuYn=Y&ReportGB=&NewMenuID=11&stkGb=&strResearchYN=">FnGuide 바로가기</a>
    </div>
    <!-- 종목 기본 정보 END-->
    <div class="a-line"></div>
    
    <div class="report-title" id="finance-datas">재무정보</div>
    <div class="financial-statements">
        <div class="fs-table">
    
    
            <!-- 연간 -->
            <div class="fs-head">
                <div class="fs-title" id="fs-table-1">연간</div>
                <div class="fs-unit">단위: 억원, %, 배</div>
            </div>
            <div class="fs-div">
                <table class="fs-data">
                    <thead>
                        <th>IFRS(연결)</th>
                        <th>2020/12</th>
                        <th>2021/12</th>
                        <th>2022/12</th>
                        <th>2023/12(E)</th>
                    </thead>
                    <tbody>
                        <tr>
                            <th>매출액</th>
                            <td><span>11,959</span></td>
                            <td><span>13,874</span></td>
                            <td><span>15,422</span></td>
                            <td><span>15,816</span></td>
                        </tr>
                        <tr>
                            <th><span>영업이익</span></th>
                            <td><span>1,021</span></td>
                            <td><span>1,522</span></td>
                            <td><span>1,683</span></td>
                            <td><span>1,612</span></td>
                        </tr>
                        <tr>
                            <th>영업이익률</th>
                            <td><span>8.54</span></td>
                            <td><span>10.97</span></td>
                            <td><span>10.91</span></td>
                            <td><span>10.19</span></td>
                        </tr>
                        <tr>
                            <th>당기순이익</th>
                            <td><span>849</span></td>
                            <td><span>1,115</span></td>
                            <td><span>1,207</span></td>
                            <td><span>1,208</span></td>
                        </tr>
                        <tr>
                            <th>당기순이익률</th>
                            <td><span>7.10</span></td>
                            <td><span>8.04</span></td>
                            <td><span>7.83</span></td>
                            <td><span>7.64</span></td>
                        </tr>
                        <tr><!--
                            <th>지배주주지분</th>
                            <td>11,221</td>
                            <td>12,378</td>
                            <td>13,362</td>
                            <td>14,400</td>
                            -->
                        </tr>
                        <tr>
                            <th>자본총계</th>
                            <td>11,260</td>
                            <td>12,404</td>
                            <td>13,365</td>
                            <td>14,394</td>
                        </tr>
                        <tr>
                            <th>자본금</th>
                            <td>123</td>
                            <td>123</td>
                            <td>123</td>
                            <td>122</td>
                        </tr>
                        <tr>
                            <th>자본잠식률</th>
                            <td><span>정상</span></td>
                            <td><span>정상</span></td>
                            <td><span>정상</span></td>
                            <td><span>정상</span></td>
                        </tr>
                        <tr>
                            <th>ROE</th>
                            <td><span>7.85</span></td>
                            <td><span>9.71</span></td>
                            <td><span>9.56</span></td>
                            <td><span>8.80</span></td>
                        </tr>
                        <tr>
                            <th>PER</th>
                            <td><span class="good-value">8.76</span></td>
                            <td><span class="good-value">7.65</span></td>
                            <td><span class="good-value">5.42</span></td>
                            <td><span class="good-value">4.78</span></td>
                        </tr>
                        <tr>
                            <th>PBR</th>
                            <td><span class="good-value">0.65</span></td>
                            <td><span class="good-value">0.70</span></td>
                            <td><span class="good-value">0.49</span></td>
                            <td><span class="good-value">0.40</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- 연간 END -->
            <!-- 연간 Chart -->
            <div class="fs-chard-div">
                <canvas class="fs-y-chart"></canvas>
                <script>
                    financeSetChart('.fs-y-chart', ['2020/12', '2021/12', '2022/12', '2023/12(E)'], [
                        [11959, 13874, 15422, 15816],
                        [1021, 1522, 1683, 1612],
                        [849, 1115, 1207, 1208],
                        [8.54, 10.97, 10.91, 10.19],
                        [7.1, 8.04, 7.83, 7.64],
                    ]);
                </script>
            </div>
            <!-- 연간 Chart END -->
            

    <div class="goto-summary">
        <a title="연간재무제표 요약 바로가기" href="#fs-summary-1">연간재무제표 요약 바로가기</a>
    </div>
    
            <!-- 분기 -->
            <div class="fs-head">
                <div class="fs-title" id="fs-table-2">분기</div>
                <div class="fs-unit">단위: 억원, %, 배</div>
            </div>
            <div class="fs-div">
                <table class="fs-data">
                    <thead>
                        <th>IFRS(연결)</th>
                        <th>2023/03</th>
                        <th>2023/06(E)</th>
                        <th>2023/09(E)</th>
                        <th>2023/12(E)</th>
                    </thead>
                    <tbody>
                        <tr>
                            <th>매출액</th>
                            <td><span>4,059</span></td>
                            <td><span>3,594</span></td>
                            <td><span>3,462</span></td>
                            <td><span>4,701</span></td>
                        </tr>
                        <tr>
                            <th><span>영업이익</span></th>
                            <td><span>543</span></td>
                            <td><span>240</span></td>
                            <td><span>323</span></td>
                            <td><span>507</span></td>
                        </tr>
                        <tr>
                            <th>영업이익률</th>
                            <td><span>13.38</span></td>
                            <td><span>6.68</span></td>
                            <td><span>9.33</span></td>
                            <td><span>10.78</span></td>
                        </tr>
                        <tr>
                            <th>당기순이익</th>
                            <td><span>443</span></td>
                            <td><span>169</span></td>
                            <td><span>224</span></td>
                            <td><span>373</span></td>
                        </tr>
                        <tr>
                            <th>당기순이익률</th>
                            <td><span class="good-value">10.91</span></td>
                            <td><span>4.70</span></td>
                            <td><span>6.47</span></td>
                            <td><span>7.93</span></td>
                        </tr>
                        <tr><!--
                            <th>지배주주지분</th>
                            <td>13,618</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            -->
                        </tr>
                        <tr>
                            <th>자본총계</th>
                            <td>13,614</td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <th>자본금</th>
                            <td>123</td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <th>자본잠식률</th>
                            <td><span>정상</span></td>
                            <td><span></span></td>
                            <td><span></span></td>
                            <td><span></span></td>
                        </tr>
                        <tr>
                            <th>ROE</th>
                            <td><span>13.33</span></td>
                            <td><span>5.21</span></td>
                            <td class="weight-value"><span>7.92</span></td>
                            <td class="weight-value"><span>7.92</span></td>
                        </tr>
                        <tr>
                            <th>PER</th>
                            <td><span></span></td>
                            <td><span></span></td>
                            <td><span></span></td>
                            <td><span></span></td>
                        </tr>
                        <tr>
                            <th>PBR</th>
                            <td><span class="good-value">0.46</span></td>
                            <td><span></span></td>
                            <td><span></span></td>
                            <td><span></span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- 분기 END -->
            <!-- 분기 Chart -->
            <div class="fs-chard-div">
                <canvas class="fs-q-chart"></canvas>
                <script>
                    financeSetChart('.fs-q-chart', ['2023/03', '2023/06(E)', '2023/09(E)', '2023/12(E)'], [
                        [4059, 3594, 3462, 4701],
                        [543, 240, 323, 507],
                        [443, 169, 224, 373],
                        [13.38, 6.68, 9.33, 10.78],
                        [10.91, 4.7, 6.47, 7.93],
                    ]);
                </script>
            </div>
            <!-- 분기 Chart END -->
            <div class="goto-summary">
    <a title="분기재무제표 요약 바로가기" href="#fs-summary-2">분기재무제표 요약 바로가기</a>
    </div>

    
    
            <!-- 재무상태표 -->
            <div class="fs-head" style="margin-top: 20px">
                <div class="fs-title">재무상태표</div>
                <div class="fs-unit">단위: 억원, %</div>
            </div>
            <div class="fs-div">
                <table class="fs-data">
                    <thead>
                        <th>IFRS(연결)</th>
                        <th>2020/12</th>
                        <th>2021/12</th>
                        <th>2022/12</th>
                        <th>2023/03</th>
                    </thead>
                    <tbody>
                        <tr>
                            <th>자산</th>
                            <td>14,385</td>
                            <td>15,571</td>
                            <td>16,847</td>
                            <td>18,034</td>
                        </tr>
                        <tr>
                            <th>부채</th>
                            <td>3,125</td>
                            <td>3,167</td>
                            <td>3,482</td>
                            <td>4,420</td>
                        </tr>
                        <tr>
                            <th>자본</th>
                            <td>11,260</td>
                            <td>12,404</td>
                            <td>13,365</td>
                            <td>13,614</td>
                        </tr>
                        <!--
                        <tr>
                            <th>부채비율</th>
                            <td><span class="good-value">28</span></td>
                            <td><span class="good-value">26</span></td>
                            <td><span class="good-value">26</span></td>
                            <td><span class="good-value">32</span></td>
                        </tr>
                        -->
                    </tbody>
                </table>
            </div>
            <!-- 재무상태표 END -->

    
            <!-- 재무비율 -->
            <div class="fs-head" style="margin-top: 20px">
                <div class="fs-title" id="fs-table-3">재무비율</div>
                <div class="fs-unit">단위: %, 억원</div>
            </div>
            <div class="fs-div">
                <table class="fs-data">
                    <thead>
                        <th>IFRS(연결)</th>
                        <th>2020/12</th>
                        <th>2021/12</th>
                        <th>2022/12</th>
                        <th>2023/03</th>
                    </thead>
                    <tbody>
                        <tr>
                            <th>유동비율</th>
                            <td><span class="good-value">355.0</span></td>
                            <td><span class="good-value">358.1</span></td>
                            <td><span class="good-value">356.9</span></td>
                            <td><span class="good-value">241.1</span></td>
                        </tr>
                        <tr>
                            <th>당좌비율</th>
                            <td><span class="good-value">161.7</span></td>
                            <td><span class="good-value">171.2</span></td>
                            <td><span class="good-value">162.1</span></td>
                            <td><span class="bad-value">91.4</span></td>
                        </tr>
                        <tr>
                            <th>부채비율</th>
                            <td><span class="good-value">27.8</span></td>
                            <td><span class="good-value">25.5</span></td>
                            <td><span class="good-value">26.1</span></td>
                            <td><span class="good-value">32.5</span></td>
                        </tr>
                        <tr>
                            <th>유보율</th>
                            <td>9,192.0</td>
                            <td>10,131.3</td>
                            <td>10,930.3</td>
                            <td>11,138.0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="fs-comment-text">유보율은 높을수록 좋다.</div>
            <!-- 재무비율 END -->
            <!-- 재무상태표/재무비율 Chart -->
            <div class="fs-chard-div">
                <canvas class="fs-bar-chart"></canvas>
                <script>
                    const fsBarChart = document.querySelector('.fs-bar-chart').getContext('2d');
                    const deptRatio = [27.75, 25.53, 26.05, 32.47];
                    const fsBarCanvas = new Chart(fsBarChart, {
                        type: 'bar',
                        data: {
                            labels: ['2020/12', '2021/12', '2022/12', '2023/03'],
                            datasets: [{
                                    label: '자본',
                                    data: [11260, 12404, 13365, 13614],
                                    backgroundColor: 'rgba(16, 163, 127, 0.2)',
                                    borderColor: 'rgba(16, 163, 127, 1)',
                                    borderWidth: 1,
                                    stack: 'combined',
                                    yAxisID: 'y1',
                                },
                                {
                                    label: '부채',
                                    data: [3125, 3167, 3482, 4420],
                                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                    borderColor: 'rgba(255, 99, 132, 1)',
                                    borderWidth: 1,
                                    stack: 'combined',
                                    yAxisID: 'y1',
                                }, {
                                    label: '부채비율',
                                    data: deptRatio,
                                    backgroundColor: 'rgba(0, 0, 128, 0.2)',
                                    borderColor: 'rgba(0, 0, 128, 1)',
                                    borderWidth: 1,
                                    type: 'line',
                                    yAxisID: 'y2',
                                }
                            ]
                        },
                        options: {
                            scales: {
                                y1: {
                                    beginAtZero: true,
                                    stacked: true,
                                    position: 'left',
                                    ticks: {
                                        stepSize: 10000,
                                        callback: function(value, index, ticks) {
                                            return `${value.toLocaleString()}억원`;
                                        }
                                    }
                                },
                                y2: {
                                    beginAtZero: true,
                                    position: 'right',
                                    grid: {
                                        drawOnChartArea: false,
                                    },
                                    ticks: {
                                        callback: function(value, index, ticks) {
                                            return `${value.toLocaleString()}%`;
                                        }
                                    },
                                    min: Math.round((Math.min(...deptRatio) / 5) * 5) - 5,
                                    max: Math.round((Math.max(...deptRatio) / 5) * 5) + 5,
                                    stepSize: 5
                                }
                            },
                        }
                    });
                </script>
            </div>
            <div class="goto-summary">
                <a title="재무비율 요약 바로가기" href="#fs-summary-3">재무비율 요약 바로가기</a>
            </div>
            <!-- 재무상태표/재무비율 Chart END -->
    
            <!-- 현금흐름표 -->
            <div class="fs-head" style="margin-top: 20px">
                <div class="fs-title" id="fs-table-4">현금흐름표</div>
                <div class="fs-unit">단위: 억원</div>
            </div>
            <div class="fs-div">
                <table class="fs-data">
                    <thead>
                        <th>IFRS(연결)</th>
                        <th>2020/12</th>
                        <th>2021/12</th>
                        <th>2022/12</th>
                        <th>2023/03</th>
                    </thead>
                    <tbody>
                        <tr>
                            <th>영업활동</th>
                            <td><span>1,494</span></td>
                            <td><span>1,721</span></td>
                            <td><span>672</span></td>
                            <td><span>1</span></td>
                        </tr>
                        <tr>
                            <th>투자활동</th>
                            <td><span class="minus-value">-1,478</span></td>
                            <td><span class="minus-value">-980</span></td>
                            <td><span class="minus-value">-732</span></td>
                            <td><span class="minus-value">-1,430</span></td>
                        </tr>
                        <tr>
                            <th>재무활동</th>
                            <td><span>54</span></td>
                            <td><span class="minus-value">-502</span></td>
                            <td><span>41</span></td>
                            <td><span>901</span></td>
                        </tr>
                        <tr>
                            <th rowspan="2">구분</th>
                            <td><span class="good-value">+/-/+</span></td>
                            <td><span class="good-value">+/-/-</span></td>
                            <td><span class="good-value">+/-/+</span></td>
                            <td><span class="good-value">+/-/+</span></td>
                        </tr>
                        <tr>
                            <td><span class="good-value">성장</span></td>
                            <td><span class="good-value">우량</span></td>
                            <td><span class="good-value">성장</span></td>
                            <td><span class="good-value">성장</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="goto-summary">
                <a title="현금흐름표 요약 바로가기" href="#fs-summary-4">현금흐름표 요약 바로가기</a>
            </div>
            <!-- 현금흐름표 END -->
            <div class="a-line"></div>
            <br/>
            <div style="max-width: 600px;margin-bottom: 30px;">
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5461323615661647"
                crossorigin="anonymous"></script>
            <!-- POSTAD -->
            <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-5461323615661647"
                data-ad-slot="3674534741"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
            </div>
            <br/>
            
    
            <!-- 적정주가 계산 파트 -->
            <div class="report-title" id="fs-calc-result">적정주가 계산</div>
            <!-- 영업이익*PER 적정 주가 계산 -->
            <div class="fs-head fs-with-q" style="margin-top: 20px;margin-bottom: 10px">
                <div class="fs-with-q">
                    <div class="fs-title" id="fs-table-5">영업이익*PER</div>
                    <div>
                        <a href="https://waymond.tistory.com/40" title="적정주가 간단하게 계산해보기">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" />
                        </svg>                  
                        </a>
                    </div>
                </div>
            </div>
            <div class="standard-info">
                <div class="info">
                    <div class="info-cell">
                        <div class="cell-head">영업이익</div>
                        <div class="cell-desc">1,612억원</div>
                    </div>

                    <div class="info-cell">
                        <div class="cell-head">기준</div>
                        <div class="cell-desc">2023/12(E)</div>
                    </div>
                </div>
                <div class="info-one">
                    <div class="cell-head">현재주가</div>
                    <div class="cell-desc">23,050원</div>
                </div>
                <div class="info-one">
                    <div class="cell-head">발행주식수</div>
                    <div class="cell-desc">24,630,000</div>
                </div>
            </div>
            <div class="fs-div" style="margin-top: 10px">
                <table class="fs-data">
                    <thead>
                        <th>구분</th>
                        <th>PER</th>
                        <th>기업가치</th>
                        <th>적정주가</th>
                    </thead>
                    <tbody>
                        <tr>
                            <th>올해 예상</th>
                            <td>4.78</td>
                            <td>7,705억원</td>
                            <td>31,283원</td>
                        </tr>
                        <tr>
                            <th>가중 평균</th>
                            <td>6.72</td>
                            <td>10,833억원</td>
                            <td>43,983원</td>
                        </tr>
                        <tr>
                            <th><a href="https://finance.naver.com/sise/sise_group_detail.naver?type=upjong&no=274">업종 (NV)</a></th>
                            <td>8.27</td>
                            <td>13,331억원</td>
                            <td>54,125원</td>
                        </tr>
                        <tr>
                            <th><a href="http://comp.fnguide.com/SVO2/ASP/SVD_ujanal.asp?pGB=1&gicode=A020000&cID=&MenuYn=Y&ReportGB=&NewMenuID=110&stkGb=701">업종 (FG)</a></th>
                            <td>8.37</td>
                            <td>13,492억원</td>
                            <td>54,779원</td>
                        </tr>
                        <tr>
                            <th>별도 조정</th>
                            <td class="per-input">
                                <div>
                                    <input class="custom-input" value="10" type="number" min="0" max="100" step="1" />
                                </div>
                                <div>
                                    PER 입력
                                </div>
                            </td>
                            <td><span class="custom-value per-fair-value"></span></td>
                            <td><span class="custom-value per-fair-price"></span></td>
                        </tr>
                    </tbody>
                </table>
                
            </div>
            <div class="fs-comment-text">
                <div><b>별도 조정의 PER은 직접 수정 가능합니다.</b></div>
                <div>NV=NAVER 증권 기준 동일 업종 PER</div>
                <div>FG=FnGuide 기준 동일 업종 PER</div>
            </div>
            <!-- 영업이익*PER END -->
            <!-- 영업이익*PER Chart -->
            <div class="fs-chard-div">
                <canvas class="fs-per-chart"></canvas>
                <script>
                    const perCanvas = document.querySelector('.fs-per-chart').getContext('2d');
                    const nowValue = 23050;
                    let calcPer = 0;
                    const perChart = new Chart(perCanvas, {
                        type: 'line',
                        data: {
                            labels: ['올해 예상', '가중 평균', '업종 PER(NV)', '업종 PER(CG)', '별도 조정'],
                            datasets: [{
                                label: '적정주가',
                                data: [31283, 43983, 54125, 54779, calcPer],
                                backgroundColor: 'rgba(16, 163, 127, 0.2)',
                                borderColor: 'rgba(16, 163, 127, 1)',
                                borderWidth: 1,
                                type: 'bar'
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    position: 'left',
                                    ticks: {
                                        callback: function(value, index, ticks) {
                                            return `${value.toLocaleString()}원`;
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    onClick: (e) => e.stopPropagation()
                                },
                                annotation: {
                                    annotations: {
                                        currentValue: {
                                            type: 'line',
                                            mode: 'horizontal',
                                            scaleID: 'y',
                                            value: nowValue,
                                            borderColor: 'rgba(255, 127, 80, 1)',
                                            borderWidth: 1.5,
                                            label: {
                                                content: '현재 주가',
                                                enabled: true,
                                                position: 'top',
                                            }
                                        },
                                        label1: {
                                            type: 'label',
                                            yValue: nowValue,
                                            content: [`현재 주가 ${nowValue.toLocaleString()}원`, ''],
                                            color: 'rgba(255, 127, 80, 1)',
                                            font: {
                                                size: 13,
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    });

                    const perInput = document.querySelector('.per-input');
                    const perHandler = (perValue) => {
                        const fairValue = document.querySelector('.per-fair-value');
                        const fairPrice = document.querySelector('.per-fair-price');

                        if (parseInt(perValue) > 100) {
                            perValue = 100;
                        }

                        const earning = 1612; // 영업이익
                        const stockCnt = 24630000; // 발행주식수
                        const per = parseFloat(perValue);

                        // 기업가치
                        let calcEarning = earning * per;
                        let calcPrice = (calcEarning / stockCnt) * 100000000;

                        calcEarning = calcEarning.toFixed(1);
                        calcPrice = calcPrice.toFixed(0);

                        if (isNaN(calcEarning)) {
                            fairValue.innerHTML = '';
                            fairPrice.innerHTML = '';
                            calcPrice = 0;
                        } else {
                            fairValue.innerHTML = `${parseFloat(calcEarning).toLocaleString()}억원`;
                            fairPrice.innerHTML = `${parseInt(calcPrice).toLocaleString()}원`;
                        }

                        calcPer = calcPrice;
                        perChart.data.datasets[0].data[4] = calcPer;

                        perChart.update();
                    };

                    perInput.addEventListener('input', (event) => {
                        perHandler(event.target.value);
                    });
                    perHandler(10);
                </script>
            </div>
            <div class="goto-summary">
                <a title="영업이익*PER 요약 바로가기" href="#fs-summary-5">적정주가 계산 요약 바로가기</a>
            </div>
            <!-- 영업이익*PER Chart END -->
    
            <!-- SRIM 계산 -->
            <div class="fs-head fs-with-q" style="margin-top: 20px;margin-bottom: 10px">
                <div class="fs-with-q">
                    <div class="fs-title" id="fs-table-6">SRIM</div>
                    <div>
                        <a href="https://waymond.tistory.com/41" title="주식투자 전략:SRIM으로 적정주가 계산">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" />
                        </svg>                  
                        </a>
                    </div>
                </div>
            </div>
            <div class="standard-info">
                <div class="info-one">
                    <div class="cell-head">발행주식수</div>
                    <div class="cell-desc">24,630,000</div>
                </div>
                <div class="info-one">
                    <div class="cell-head">자사주</div>
                    <div class="cell-desc">2,660,406</div>
                </div>

                <div class="info-one">
                    <div class="cell-head">지배주주지분</div>
                    <div class="cell-desc">13,362</div>
                </div>

                <div class="info-one">
                    <div class="cell-head">회사채 할인율</div>
                    <div class="cell-desc fs-flex">
                        <div class="fs-disc-rate">11.02%</div>
                        <div>
                            <div class="srim-ratio-btn">변경</div>
                        </div>
                    </div>
                </div>

                <div class="info">
                    <div class="info-cell">
                        <div class="cell-head">예상 ROE</div>
                        <div class="cell-desc">8.80</div>
                    </div>
                    <div class="info-cell">
                        <div class="cell-head">가중 ROE</div>
                        <div class="cell-desc">9.33</div>
                    </div>
                </div>
            </div>
            <div class="fs-comment-text">
                회사채 수익률의 기본값은 BBB- 등급의 5년 수익률입니다.
            </div>
            <div id="myModal" class="fs-modal">
                <div class="modal-content">
                    <div class="close">&times;</div>
                    <div class="fs-spread-head">등급별금리스프레드</div>
                    <div class="fs-spread-date">기준일: 2023.06.29 / 단위:%</div>
                    <div class="fs-accordion">
                        
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">국고채</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">3.5</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">3.46</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">3.56</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">3.53</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">3.66</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">3.66</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">3.6</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">3.6</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">AAA</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">3.8</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">3.84</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">3.9</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">3.97</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">4.06</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">4.13</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">4.19</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">4.32</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">AA+</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">3.88</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">3.92</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">3.99</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">4.05</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">4.15</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">4.25</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">4.31</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">4.46</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">AA</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">3.93</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">3.97</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">4.03</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">4.1</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">4.18</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">4.28</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">4.35</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">4.52</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">AA-</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">3.97</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">4.0</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">4.07</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">4.14</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">4.24</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">4.34</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">4.42</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">4.64</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">A+</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">4.37</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">4.55</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">4.61</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">4.64</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">4.79</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">4.91</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">5.05</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">5.39</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">A</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">4.51</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">4.71</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">4.78</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">4.81</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">4.97</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">5.09</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">5.32</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">5.85</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">A-</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">4.74</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">4.96</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">5.05</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">5.09</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">5.28</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">5.43</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">5.77</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">6.45</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">BBB+</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">5.47</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">6.0</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">6.42</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">6.66</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">7.14</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">7.77</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">8.38</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">8.55</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">BBB</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">5.85</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">6.5</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">7.0</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">7.33</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">7.95</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">8.71</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">9.43</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">9.6</button>
                            </div>
                            </div>
                        </div>
                        <div class="fs-accordion-item">
                            <button class="fs-accordion-btn">BBB-</button>
                            <div class="fs-accordion-content fs-spread-list">
                            
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3월</div>
                                <button class="fs-spread-value">6.52</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">6월</div>
                                <button class="fs-spread-value">7.29</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">9월</div>
                                <button class="fs-spread-value">7.93</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년</div>
                                <button class="fs-spread-value">8.32</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">1년6월</div>
                                <button class="fs-spread-value">9.06</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">2년</div>
                                <button class="fs-spread-value">9.86</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">3년</div>
                                <button class="fs-spread-value">10.8</button>
                            </div>
                            <div class="fs-spread-item">
                                <div class="fs-spread-month">5년</div>
                                <button class="fs-spread-value">11.02</button>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script>
// SRIM Calculator
const srimCalculator = (ipROE, ipStockCnt, ipSelf, ipInter, ipRate)=>{
    if( ipROE == null) return;
    const dan = 100000000;
    // 기업가치
    const numerator = ipInter*(ipROE - ipRate);
    const b0 = ipInter + (numerator/ipRate);
    
    // 주식수
    const realCnt = ipStockCnt - ipSelf;

    // 적정주가
    const fairValue = (b0*dan)/realCnt;
    //console.log(Math.round(fairValue));

    // 초과이익
    const excessProfit = ipInter*((ipROE/100) - (ipRate/100));
    // 초과이익, 초과손실
    const excessFlag = excessProfit > 0 ? true : false;

    let ws = {
        w1 : 1,
        w2 : 0.9,
        w3 : 0.8,
        w4 : 0.7,
        w5 : 0.6,
        w6 : 0.5,
    }

    Object.entries(ws).forEach(([key, value]) => {
        const deno = (1+(ipRate/100)) - value;
        const wCalc = value/deno;
        const svalue = ipInter + (excessProfit*wCalc);
        const sprice = (svalue/realCnt)*dan;
        ws[key] = {
            svalue: Math.round(svalue),
            sprice: Math.round(sprice)
        }
    });

    return {
        flag : excessFlag,
        srim: ws
    }
}

const setSrimResult = (tableClass, ipROE, ipRate)=>{
    if( ipROE == null ){
        return [];
    }
    const ws = srimCalculator(ipROE, 24630000, 2660406, 13362, ipRate);
    // SRIM Table
    const srimTable = document.querySelector(tableClass);
    if( srimTable == undefined ){
        return [];
    };
    if( ws == null ){
        return [];
    };

    const flagTH = srimTable.querySelector('.srim-flag span');
    if( ws.flag ){       
        flagTH.innerHTML = '초과이익';
        flagTH.classList.remove('bad-value');
    } else {
        flagTH.innerHTML = '초과손실';
        flagTH.classList.add('bad-value');
    }

    const srimValueCell = srimTable.querySelectorAll('.srim-value');
    const srimPriceCell = srimTable.querySelectorAll('.srim-price');

    const srims = ws.srim;
    let resultList = [];
    Object.entries(srims).forEach(([key, srim], index)=>{
        srimValueCell[index].innerHTML = `${srim.svalue.toLocaleString()}억`;
        srimPriceCell[index].innerHTML = `${srim.sprice.toLocaleString()}원`;
        resultList.push(srim.sprice);
    });

    return resultList;
}

document.addEventListener('DOMContentLoaded', (event) => {
    const modal = document.querySelector('#myModal');
    const btn = document.querySelector(".srim-ratio-btn");
    const span = modal.querySelector(".close");

    btn.onclick = function() {
        modal.style.display = "block";
    }

    span.onclick = function() {
        modal.style.display = "none";
    }

    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }


    const accordionButtons = document.querySelectorAll('.fs-accordion-btn');

    accordionButtons.forEach(function (button) {
    button.addEventListener('click', function () {
        const accordionContent = this.nextElementSibling.querySelector('.fs-accordion-content');
        const accordionItem = this.parentElement;
        const openItem = document.querySelector('.fs-accordion-item.open');

        if (openItem && openItem !== accordionItem) {
            closeAccordion(openItem);
        }

        if (accordionItem.classList.contains('open')) {
            closeAccordion(accordionItem);
        } else {
            openAccordion(accordionItem);
        }
        });
    });

    function openAccordion(accordionItem) {
        const content = accordionItem.querySelector('.fs-accordion-content');
        accordionItem.classList.add('open');
        content.style.maxHeight = content.scrollHeight + 'px';
    }

    function closeAccordion(accordionItem) {
        const content = accordionItem.querySelector('.fs-accordion-content');
        accordionItem.classList.remove('open');
        content.style.maxHeight = null;
    }
});
            </script>
            <div class="srim-page">
                <div class="srim-roe-head">
                    <div class="srim-roe roe-selected">예상 ROE</div>
                    <div class="srim-roe ">가중 ROE</div>
                    <div class="srim-roe-info">기준 ROE 선택</div>
                </div>
                <div class="fs-comment-text" style="margin-top: 5px">
                    <b>ROE가 회사채 수익률보다 낮은 경우</b>에는 <b>'초과이익'이 아닌</b> <span class="bad-value"><b>'초과손실' 기준</b></span>으로 판단합니다.
                </div>
                <div class="fs-div srim-result" style="margin-top: 10px">
                    <table class="srim-e-roe fs-data srim-table">
                        <thead>
                            <th class="srim-flag"><span></span></th>
                            <th>기업가치</th>
                            <th>적정주가</th>
                        </thead>
                        <tbody>
                            <tr>
                                <th>지속</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>10% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>20% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>30% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>40% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>50% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                        </tbody>
                    </table>

                    <table class="srim-w-roe fs-data srim-table post-fs-hidden">
                        <thead>
                            <th class="srim-flag"><span></span></th>
                            <th>기업가치</th>
                            <th>적정주가</th>
                        </thead>
                        <tbody>
                            <tr>
                                <th>지속</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>10% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>20% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>30% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>40% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                            <tr>
                                <th>50% 감소</th>
                                <td class="srim-value"></td>
                                <td class="srim-price"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- SRIM END -->
            <!-- SRIM Chart -->
            <div class="fs-chard-div">
                <canvas class="fs-srim-chart"></canvas>
            </div>
            <script>
            // SRIM CHART
            const srimCanvas = document.querySelector('.fs-srim-chart').getContext('2d');
            let srimResults = [
                setSrimResult('.srim-e-roe', 8.8, 11.02),
                setSrimResult('.srim-w-roe', 9.33, 11.02),
            ];
            const srimNowValue = 23050;
            let setSRIM = srimResults[0];
            const srimChart = new Chart(srimCanvas, {
                type: 'line',
                data: {
                    labels: ['지속', '10% 감소', '20% 감소', '30% 감소', '40% 감소', '50% 감소'],
                    datasets: [{
                        label: '적정주가',
                        data: setSRIM,
                        backgroundColor: 'rgba(16, 163, 127, 0.2)',
                        borderColor: 'rgba(16, 163, 127, 1)',
                        borderWidth: 1,
                        type: 'bar'
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            position: 'left',
                            ticks: {
                                callback: function(value, index, ticks) {
                                    return `${value.toLocaleString()}원`;
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            onClick: (e) => e.stopPropagation()
                        },
                        annotation: {
                            annotations: {
                                currentValue: {
                                    type: 'line',
                                    mode: 'horizontal',
                                    scaleID: 'y',
                                    value: srimNowValue,
                                    borderColor: 'rgba(255, 127, 80, 1)',
                                    borderWidth: 1.5,
                                    label: {
                                        content: '현재 주가',
                                        enabled: true,
                                        position: 'top',
                                    }
                                },
                                label1: {
                                    type: 'label',
                                    yValue: srimNowValue,
                                    content: [`현재 주가 ${srimNowValue.toLocaleString()}원`, ''],
                                    color: 'rgba(255, 127, 80, 1)',
                                    font: {
                                        size: 13,
                                    }
                                }
                            }
                        }
                    }
                }
            });
            // ROE 선택 기능
            const roeBtn = document.querySelectorAll('.srim-roe');
            const roeSelected = 'roe-selected';
            const roeHandler = (index) => {
                const roeHead = document.querySelector('.srim-roe-head');
                const selectedRoe = roeHead.querySelector(`.${roeSelected}`);
                const roeTables = document.querySelectorAll('.srim-table');
                selectedRoe.classList.remove(roeSelected);

                roeBtn[index].classList.add(roeSelected);
                roeTables.forEach((table) => {
                    table.classList.add('post-fs-hidden');
                });
                roeTables[index].classList.remove('post-fs-hidden');

                // Chart update
                setSRIM = srimResults[index];
                srimChart.data.datasets[0].data = setSRIM;

                srimChart.update();
            };

            roeBtn.forEach((roe, index) => {
                roe.addEventListener('click', () => {
                    roeHandler(index);
                });
            });


            const setSrimValue = (tableClass, ipRoe, ipRate) => {
                const srimTable = document.querySelector(tableClass);
                if( srimTable == undefined || srimTable == null ) return;

                const srimResult = setSrimResult(tableClass, ipRoe, ipRate);
                
                const resultIndex = tableClass === '.srim-e-roe' ? 0 : 1;
                srimResults[resultIndex] = srimResult
                setSRIM = srimResults[resultIndex];
                // Chart update
                srimChart.data.datasets[0].data = srimResult;
                srimChart.update();
            }

            document.addEventListener('DOMContentLoaded', ()=>{
                const accoValues = document.querySelectorAll('.fs-spread-value');
                const modal = document.querySelector('#myModal');
                accoValues.forEach((acco)=>{
                    acco.addEventListener('click', ()=>{
                        document.querySelector('.fs-disc-rate').innerHTML = `${acco.innerHTML}%`;
                        const accoFloat = parseFloat(acco.innerHTML);
                        modal.style.display = "none";

                        setSrimValue('.srim-e-roe', 8.8, accoFloat);
                        setSrimValue('.srim-w-roe', 9.33, accoFloat);
                        const roes = document.querySelectorAll('.srim-roe');

                        if( !roes[0].classList.contains('fs-hidden') ){
                            roes[0].click();
                        }else{
                            roes[1].click();
                        }
                    })
                });
            });
        </script>
        <!-- SRIM Chart END -->
        <div class="goto-summary">
            <a title="SRIM 요약 바로가기" href="#fs-summary-6">SRIM 계산 요약 바로가기</a>
        </div>
        <div class="a-line"></div>
        </div>
    </div>
    <script type="text/javascript">
    const links = document.querySelectorAll('.goto-summary a');

    links.forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();

        const target = document.querySelector(this.getAttribute('href'));
        if( target === null || target === undefined ){
            return;
        }

        target.scrollIntoView({ behavior: 'smooth' });

        target.classList.add('summary-focus');

        setTimeout(() => {
            target.classList.remove('summary-focus');
        }, 2000);
    });
    });
    </script>
    <!-- END -->
    <!-- AI 분석 -->
    <div style="display: hidden;" id="fs-summary-ai"></div>

    <!-- 여기에 ChatGPT 내용 삽입 -->
    <!-- AI 분석 END -->
    <div class="a-line"></div>
    <!-- BUY ME A COFFEE -->
    <div style="max-width: 600px; display: flex; align-items: center; justify-content: center; margin-bottom: 30px;">
        <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="duron7456a" data-color="#2cddb1" data-emoji="☕"  data-font="Poppins" data-text="커피 한 잔으로 저를 응원해주세요! " data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#FFDD00" ></script>
    </div>
    <!-- BUY ME A COFFEE END -->
    <div class="fs-mypost-list">
        <div class="fs-mypost">📗 관련 포스트</div>
        <div class="fs-mypost-link">
            <a href="https://waymond.tistory.com/14">
                <div>주식 초보자 마인드 셋</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="https://waymond.tistory.com/16">
                <div>상장폐지 조건</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="https://waymond.tistory.com/22">
                <div>기본적 분석/기술적 분석</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="https://waymond.tistory.com/23">
                <div>재무제표에 대해서</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="https://waymond.tistory.com/27">
                <div>재무제표에서 꼭 확인해야 하는 것들</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="https://waymond.tistory.com/40">
                <div>간단한 적정주가 계산:영업이익*PER</div>
            </a>
        </div>
        <div class="fs-mypost-link">
            <a href="https://waymond.tistory.com/41">
                <div>SRIM으로 적정주가 계산/저평가 주식</div>
            </a>
        </div>
    </div>
    